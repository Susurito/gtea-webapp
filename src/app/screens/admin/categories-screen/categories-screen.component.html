<div class="app-layout">
  <app-sidebar></app-sidebar>
  <div class="content-area">
    <main class="gestion-container">
      <header class="gestion-header">
        <h2>Gestión de Categorías</h2>
        <button mat-flat-button color="primary" (click)="crearCategoria()">
          <mat-icon>add</mat-icon>
          Nueva Categoría
        </button>
      </header>

      <!-- Tarjetas de resumen -->
      <section class="summary-cards">
        <div class="card">
          <p class="card-title">Total Categorías</p>
          <p class="card-value">{{ totalCategorias }}</p>
        </div>
        <div class="card">
          <p class="card-title">Categoría Más Usada</p>
          <p class="card-value">{{ categoriaMasUsada }}</p>
        </div>
        <div class="card">
          <p class="card-title">Total Eventos</p>
          <p class="card-value">{{ totalEventos }}</p>
        </div>
      </section>

      <!-- Tabla de categorías -->
      <div class="table-card">
        <div class="table-responsive">
          <table mat-table [dataSource]="dataSourceCategorias" class="categorias-table"
            aria-label="Tabla de Categorías">

            <!-- Nombre -->
            <ng-container matColumnDef="nombre">
              <th mat-header-cell *matHeaderCellDef>Nombre</th>
              <td mat-cell *matCellDef="let categoria">{{ categoria.nombre_categoria }}</td>
            </ng-container>

            <!-- Descripción -->
            <ng-container matColumnDef="descripcion">
              <th mat-header-cell *matHeaderCellDef>Descripción</th>
              <td mat-cell *matCellDef="let categoria">{{ categoria.descripcion }}</td>
            </ng-container>

            <!-- Eventos -->
            <ng-container matColumnDef="eventos">
              <th mat-header-cell *matHeaderCellDef>Eventos</th>
              <td mat-cell *matCellDef="let categoria">{{ categoria.eventos || 0 }}</td>
            </ng-container>

            <!-- Acciones -->
            <ng-container matColumnDef="acciones">
              <th mat-header-cell *matHeaderCellDef>Acciones</th>

              <td mat-cell *matCellDef="let categoria" class="actions-cell">
                <div class="action-buttons">
                  <button class="edit-btn" (click)="editarCategoria(categoria)">
                    <mat-icon>edit</mat-icon>
                  </button>

                  <button class="delete-btn" (click)="eliminarCategoria(categoria.id, categoria.nombre_categoria)">
                    <mat-icon>delete_forever</mat-icon>
                  </button>

                </div>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumnsCategorias"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumnsCategorias"></tr>
          </table>

          <!-- Mensaje si no hay categorías -->
          <div *ngIf="categorias.length === 0" class="no-data">
            No hay categorías registradas.
          </div>
        </div>
      </div>
    </main>
  </div>
</div>
